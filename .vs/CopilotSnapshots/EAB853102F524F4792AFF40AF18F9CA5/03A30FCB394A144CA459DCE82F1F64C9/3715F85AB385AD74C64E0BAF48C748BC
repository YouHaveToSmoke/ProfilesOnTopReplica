using System;
using System.Drawing;

namespace OnTopReplica {
    
    /// <summary>
    /// Represents a single region configuration within a profile.
    /// </summary>
    [Serializable]
    public class ProfileRegionConfiguration {
        
        public string Name { get; set; }
        
        public bool HasRegion { get; set; }

        public Rectangle RegionBounds { get; set; }

        /// <summary>
        /// Relative distance from the anchor point (0.0 to 1.0).
        /// </summary>
        public PointF? RelativeDistanceFromAnchor { get; set; }

        public bool RegionIsRelative { get; set; }
        
        public RegionAnchor RegionAnchor { get; set; }
        
        public Point WindowLocation { get; set; }

        public Size WindowSize { get; set; }

        /// <summary>
        /// Relative position of the OnTopReplica window to the source window (as percentage, 0.0 to 1.0).
        /// </summary>
        public PointF? RelativeWindowLocation { get; set; }

        /// <summary>
        /// Relative size of the OnTopReplica window to the source window (as percentage, 0.0 to 1.0).
        /// </summary>
        public SizeF? RelativeWindowSize { get; set; }

        /// <summary>
        /// Determines if the window size should scale with the source window resolution.
        /// </summary>
        public bool ScaleWithSourceWindow { get; set; }

        public double Opacity { get; set; }
        
        public bool ClickThrough { get; set; }
        
        public bool ClickForwarding { get; set; }
        
        public bool ChromeVisible { get; set; }
        
        public ScreenPosition? PositionLock { get; set; }
        
        public bool TopMost { get; set; }
        
        public ProfileRegionConfiguration() {
            Opacity = 1.0;
            ChromeVisible = true;
            TopMost = true;
            RegionAnchor = RegionAnchor.TopLeft;
        }
        
        public ProfileRegionConfiguration(string name) : this() {
            Name = name;
        }
        
        public override string ToString() {
            return Name ?? "Unnamed Configuration";
        }
    }
}
